<nav class="navbar navbar-expand-lg bg-body-tertiary sticky-top">
  <div class="container">
    <a class="navbar-brand" href="/">
      <img src="../../../assets/media/petalth-logo.png" alt="Petalth Logo" class="navbar-logo">
    </a>

    <!-- Botón Hamburguesa para cuando la pantalla es menor a lg -->
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav"
      aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <!-- Menú, collapse define que estos elementos no se muestren en móviles -->
    <div class="collapse navbar-collapse mt-2 fontfix" id="navbarNav">

      <!-- Menú del centro -->
      <ul class="navbar-nav mx-auto fs-5 gap-4">
        <!-- Si no estamos logueados... -->
        @if (!authService.currentUser()) {
        <li class="nav-item">
          <!-- [routerLinkActiveOptions]="{exact: true}" especifica que unicamente haga routerLinkActive si la url es '/' -->
          <a class="nav-link" routerLink="/" routerLinkActive="active"
            [routerLinkActiveOptions]="{exact: true}">Inicio</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" routerLink="/veterinarians" routerLinkActive="active">Veterinarios</a>
        </li>
        }
        <!-- Si estamos logueados... -->
        @if (authService.currentUser()) {
        <!-- Si somos usuarios... -->
        @if (authService.isUser()) {
        <li class="nav-item">
          <a class="nav-link" [routerLink]="['/pets', authService.currentUser()?.id]" routerLinkActive="active">
            Mis Mascotas
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" routerLink="/appointments/new" routerLinkActive="active">Pedir Cita</a>
        </li>
        }

        <!-- Si somos veterinarios... -->
        @if (authService.isVet()) {
        <li class="nav-item">
          <a class="nav-link" routerLink="/appointments" routerLinkActive="active">Mi Agenda</a>
        </li>
        }

        <!-- Si somos Administradores...-->
        @if (authService.isAdmin()) {
        <li class="nav-item">
          <a class="nav-link text-danger" routerLink="/admin/users" routerLinkActive="active">Usuarios</a>
        </li>
        }
        }
      </ul>
      <!-- Menú de la derecha -->
      <ul class="navbar-nav">
        <!-- Dropdown para pantallas grandes (lg y superior) -->
        @if (!authService.currentUser()) {
        <li class="nav-item dropdown d-none d-lg-block">
          <button class="btn btn-primary btn" type="button" data-bs-toggle="dropdown" aria-expanded="false">
            Acceso a la app
          </button>
          <div class="dropdown-menu dropdown-menu-end p-4" style="min-width: 700px;">
            <div class="row g-3">
              <!-- Columna 1: Ya tienes cuenta -->
              <div class="col-6">
                <div class="text-left">
                  <h6 class="mb-3">¿Ya tienes cuenta?</h6>
                  <p>¡Accede a tu espacio personal para gestionar la salud de tu mascota!</p>
                  <a class="btn btn-primary w-100" routerLink="/login" routerLinkActive="active">Iniciar Sesión</a>
                </div>
              </div>
              <!-- Columna 2: Primera vez aquí -->
              <div class="col-6">
                <div class="text-left">
                  <h6 class="mb-3">¿Primera vez aquí?</h6>
                  <p>¡Registrate gratis y empieza a disfrutar de todos los servicios!</p>
                  <a class="btn btn-outline-primary w-100">Regístrate</a>
                </div>
              </div>
            </div>
          </div>
        </li>
        <!-- Opciones simples para móviles (solo visible en pantallas menores a lg) -->
        <li class="nav-item d-lg-none">
          <a class="nav-link" routerLink="/login" routerLinkActive="active">Inicia Sesión</a>
        </li>
        <li class="nav-item d-lg-none">
          <a class="nav-link" href="#">Regístrate</a>
        </li>
        }
        @else {

        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle d-flex align-items-center gap-2" href="#" role="button"
            data-bs-toggle="dropdown" aria-expanded="false">

            <!-- Obtenemos la primera letra del usuario o del correo, hacemos uppercase con pipe para que salga un circulito con el usuario-->
            <div class="rounded-circle bg-primary text-white d-flex justify-content-center align-items-center"
              style="width: 35px; height: 35px; font-weight: bold;">
              {{ (authService.currentUser()?.nombre?.charAt(0) || authService.currentUser()?.email?.charAt(0)) |
              uppercase }}
            </div>

            <span class="fw-bold text-dark">
              Hola, {{ authService.currentUser()?.nombre}}
            </span>
          </a>

          <ul class="dropdown-menu dropdown-menu-end">
            <li>
              <h6 class="dropdown-header">Mi Cuenta</h6>
            </li>
            <li><a class="dropdown-item" routerLink="/profile">Mi Perfil</a></li>
            <li>
              <hr class="dropdown-divider">
            </li>
            <li>
              <button class="dropdown-item text-danger" (click)="logout()">
                Cerrar Sesión
              </button>
            </li>
          </ul>
        </li>

        }


      </ul>
    </div>
  </div>
</nav>